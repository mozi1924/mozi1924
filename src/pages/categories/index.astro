---
import Layout from "../../layouts/Layout.astro";

import { getCollection } from "astro:content";

// Get all blog posts
const allPosts = await getCollection("blog");

// Extract unique categories
const itemsByCategory = new Map<string, number>();
allPosts.forEach((post) => {
  const categories = post.data.categories || ["uncategorized"];
  categories.forEach((category: string) => {
    const count = itemsByCategory.get(category) || 0;
    itemsByCategory.set(category, count + 1);
  });
});

const categories = Array.from(itemsByCategory.keys()).sort();
---

<Layout
  title="Categories"
  description="Browse my blog posts and articles by category. From Blender tutorials to system maintenance."
>
  <div class="pt-24 pb-20 px-6 max-w-7xl mx-auto min-h-screen">
    <header class="text-center space-y-6 mb-16">
      <h1 class="text-4xl md:text-5xl font-bold text-white leading-tight">
        Categories
      </h1>
      <p class="text-xl text-gray-400">Browse articles by topic</p>
    </header>

    <div
      class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-4xl mx-auto"
    >
      {
        categories.map((category) => (
          <a
            href={`/categories/${category}`}
            class="group relative bg-[#1a1a1a] border border-white/5 rounded-2xl p-6 hover:bg-[#222] hover:-translate-y-1 transition-all duration-300"
          >
            <div class="flex items-center justify-between">
              <h2 class="text-xl font-bold text-white capitalize group-hover:text-blue-400 transition-colors">
                {category}
              </h2>
              <span class="px-3 py-1 bg-white/5 text-gray-400 rounded-full text-sm font-mono group-hover:bg-blue-500/20 group-hover:text-blue-300 transition-colors">
                {itemsByCategory.get(category)}
              </span>
            </div>
          </a>
        ))
      }
    </div>
  </div>
</Layout>
